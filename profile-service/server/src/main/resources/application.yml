micronaut:
  application:
    name: profile-ui
  server:
    port: ${SERVER_PORT:8080}
  router:
    static-resources:
      public:
        enabled: true
        paths: classpath:public
        mapping: /**
      js:
        enabled: true
        paths: classpath:public
        mapping: /profile-app.js
  security:
    # Security completely disabled - Envoy OAuth2 filter handles all authentication
    # Envoy validates the OAuth2 flow and only forwards authenticated requests
    enabled: false
    # OAuth2 client disabled - using bearer token auth only
    # oauth2:
    #   clients:
    #     oauth2server:
    #       client-id: ${OAUTH2_CLIENT_ID:profile-ui}
    #       client-secret: ${OAUTH2_CLIENT_SECRET:}
    #       openid:
    #         issuer: ${OAUTH2_ISSUER_URI:https://oauth2.cat-herding.net}
    #       authorization:
    #         url: ${OAUTH2_AUTHORIZATION_URL:}
    #       token:
    #         url: ${OAUTH2_TOKEN_URL:}
    #       scopes:
    #         - openid
    #         - profile
    #         - email
    #         - profile:read
    #         - profile:write
    #         - profile:admin
  metrics:
    enabled: true
  health:
    redis:
      enabled: false
  export:
    prometheus:
      enabled: true

redis:
  uri: ${REDIS_URI:redis://localhost:6379}
  health:
    enabled: false

auth:
  events:
    consumer:
      enabled: ${AUTH_EVENTS_CONSUMER_ENABLED:false}
      stream: ${AUTH_EVENTS_STREAM:auth:events}
      group: ${AUTH_EVENTS_CONSUMER_GROUP:profile-service}
      consumer-name: ${AUTH_EVENTS_CONSUMER_NAME:profile-service-1}
      batch-size: ${AUTH_EVENTS_BATCH_SIZE:10}
      poll-interval: ${AUTH_EVENTS_POLL_INTERVAL:5s}
      create-group: ${AUTH_EVENTS_CREATE_GROUP:true}

# MongoDB/CosmosDB Configuration
mongodb:
  uri: ${MONGODB_URI:mongodb://localhost:27017}
  database: ${MONGODB_DATABASE:profile-db}
  collection:
    profiles: profiles

endpoints:
  all:
    sensitive: false
  health:
    enabled: true
    details-visible: ANONYMOUS
  prometheus:
    enabled: true
