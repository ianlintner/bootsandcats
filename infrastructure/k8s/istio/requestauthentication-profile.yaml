apiVersion: security.istio.io/v1
kind: RequestAuthentication
metadata:
  name: profile-jwt-auth
  namespace: default
  labels:
    app.kubernetes.io/managed-by: kustomize
    project: bootsandcats
spec:
  selector:
    matchLabels:
      app: profile-service
  jwtRules:
  - issuer: "https://oauth2.cat-herding.net"
    jwksUri: "http://oauth2-server.default.svc.cluster.local:9000/oauth2/jwks"
    audiences:
    - "secure-subdomain-client"
    - "profile-service"
    - "m2m-client"
    outputPayloadToHeader: "x-jwt-payload"